FROM ubuntu:20.04

# copy scripts to image
COPY scripts /usr/local/bin
RUN chmod +x /usr/local/bin/*

WORKDIR /app

ARG DEFAULT_DISK_IMAGE_PATH=/app/data/disk.img
ARG DEFAULT_FILES_TO_MOUNT=""
ARG DEFAULT_MOUNT_PATH=/mnt
ARG DEFAULT_PARTITION_NUMBER=""
ARG DEFAULT_SCRIPT=/app/scripts/edit-disk-image

ENV \
  DISK_IMAGE_PATH="${DEFAULT_DISK_IMAGE_PATH}" \
  FILES_TO_MOUNT="${DEFAULT_FILES_TO_MOUNT}" \
  MOUNT_PATH="${DEFAULT_MOUNT_PATH}" \
  PARTITION_NUMBER="${DEFAULT_PARTITION_NUMBER}" \
  SCRIPT="${DEFAULT_SCRIPT}"

ENTRYPOINT [ "/usr/local/bin/entry-point" ]